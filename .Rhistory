tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
) %>%
tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables')
nam1 <- c('Immune response_One dose',
'Immune response_Two dose',
'Breakthrough_Susceptibility',
'Breakthrough_Severity')
# Table 1 ======================================================================
ukb <- tibble(read_delim(paste0(dir_ukb,'ukb65397.tab'))) %>%
rename(eid = f.eid) %>%
mutate(`f.26410.0.0` = if_else(is.na(`f.26410.0.0`),`f.26427.0.0`,`f.26410.0.0`)) %>%
mutate(`f.26410.0.0` = if_else(is.na(`f.26410.0.0`),`f.26426.0.0`,`f.26410.0.0`)) %>%
mutate(`f.26411.0.0` = if_else(is.na(`f.26411.0.0`),`f.26428.0.0`,`f.26411.0.0`)) %>%
mutate(`f.26411.0.0` = if_else(is.na(`f.26411.0.0`),`f.26418.0.0`,`f.26411.0.0`)) %>%
# mutate(`f.26412.0.0` = if_else(is.na(`f.26412.0.0`),`f.26429.0.0`,`f.26412.0.0`)) %>%
mutate(`f.26412.0.0` = if_else(is.na(`f.26412.0.0`),`f.26419.0.0`,`f.26412.0.0`)) %>%
mutate(`f.26413.0.0` = if_else(is.na(`f.26413.0.0`),`f.26430.0.0`,`f.26413.0.0`)) %>%
mutate(`f.26413.0.0` = if_else(is.na(`f.26413.0.0`),`f.26420.0.0`,`f.26413.0.0`)) %>%
mutate(`f.26414.0.0` = if_else(is.na(`f.26414.0.0`),`f.26421.0.0`,`f.26414.0.0`)) %>%
mutate(`f.26414.0.0` = if_else(is.na(`f.26414.0.0`),`f.26431.0.0`,`f.26414.0.0`)) %>%
mutate(`f.26415.0.0` = if_else(is.na(`f.26415.0.0`),`f.26432.0.0`,`f.26415.0.0`)) %>%
mutate(`f.26415.0.0` = if_else(is.na(`f.26415.0.0`),`f.26423.0.0`,`f.26415.0.0`)) %>%
mutate(`f.26416.0.0` = if_else(is.na(`f.26416.0.0`),`f.26434.0.0`,`f.26416.0.0`))
to  <- list()
for(i in 1:4){
coh <- tibble(read_delim(paste0(dir_results,'Cohorts/imputedData_',ch[i],'.csv'))) %>%
select("eid" = "IID", 'Sex','Age') %>%
left_join(ukb %>%
select('eid',
'Body mass index' = 'f.21001.0.0',
'Index of multiple deprivation' = 'f.26410.0.0',
'Income score' = 'f.26411.0.0',
'Employment score' = 'f.26412.0.0',
'Health score' = 'f.26413.0.0',
'Education score' = 'f.26414.0.0',
'Housing score' = 'f.26415.0.0',
'Crime score' = 'f.26416.0.0',
'Living environment score' = 'f.26417.0.0'
),
by = "eid") %>%
mutate(Sex = if_else(Sex == 0,'Female','Male')) %>%
mutate('Sex' = as.factor(Sex))
to[[i]] <- CreateTableOne(data = coh,
vars = colnames(coh[2:length(colnames(coh))])) %>%
print(showAllLevels = TRUE)
}
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
) %>%
tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables')
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
)
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
) %>%
tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables')
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
) %>%
tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x))
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables')
) %>%
left_join(tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables'),
) %>%
# Table SNPs ===================================================================
tableList_SNPs <- list()
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
left_join(tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables'),
by = 'Variables'
) %>%
# Table SNPs ===================================================================
tableList_SNPs <- list()
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename_with( ~ paste0(nam1[2],'_',.x)) %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables'),
by = 'Variables') %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename_with( ~ paste0(nam1[3],'_',.x)) %>%
mutate(Variables = rownames(to[[3]])) %>%
relocate('Variables'),
by = 'Variables') %>%
left_join(tibble(data.frame(to[[4]])) %>%
rename_with( ~ paste0(nam1[4],'_',.x)) %>%
mutate(Variables = rownames(to[[4]])) %>%
relocate('Variables'),
by = 'Variables')
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_',.x)) %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables')
tibble(data.frame(to[[1]])) %>%
rename_with( ~ paste0(nam1[1],'_','Overall'))
tibble(data.frame(to[[1]])) %>%
rename(nam1[1] = 'Overall')
tibble(data.frame(to[[1]])) %>%
rename(paste0(nam1[1]) = 'Overall')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])) %>%
relocate('Variables') %>%
by = 'Variables') %>%
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = 'Variables') %>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = 'Variables') %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = 'Variables')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level'))
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable()
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable() %>%
span_header(sep = "_")
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'centre', part = 'all')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable() %>%
span_header(sep = "_") %>%
align(j = c(2:5), align = 'center', part = 'all')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
flextable() %>%
span_header(sep = "_") %>%
align(j = c(3:5), align = 'center', part = 'all')
tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
rename(' ' = 'level') %>%
flextable() %>%
span_header(sep = "_") %>%
align(j = c(3:5), align = 'center', part = 'all')
tab <- tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
rename(' ' = 'level') %>%
flextable() %>%
span_header(sep = "_") %>%
align(j = c(3:5), align = 'center', part = 'all')
save_as_docx(values = tab, path = paste0(dir_results,'Tables/T1.docx'))
ukb <- tibble(read_delim(paste0(dir_ukb,'ukb65397.tab'))) %>%
rename(eid = f.eid) %>%
mutate(`f.26410.0.0` = if_else(is.na(`f.26410.0.0`),`f.26427.0.0`,`f.26410.0.0`)) %>%
mutate(`f.26410.0.0` = if_else(is.na(`f.26410.0.0`),`f.26426.0.0`,`f.26410.0.0`)) %>%
mutate(`f.26411.0.0` = if_else(is.na(`f.26411.0.0`),`f.26428.0.0`,`f.26411.0.0`)) %>%
mutate(`f.26411.0.0` = if_else(is.na(`f.26411.0.0`),`f.26418.0.0`,`f.26411.0.0`)) %>%
# mutate(`f.26412.0.0` = if_else(is.na(`f.26412.0.0`),`f.26429.0.0`,`f.26412.0.0`)) %>%
mutate(`f.26412.0.0` = if_else(is.na(`f.26412.0.0`),`f.26419.0.0`,`f.26412.0.0`)) %>%
mutate(`f.26413.0.0` = if_else(is.na(`f.26413.0.0`),`f.26430.0.0`,`f.26413.0.0`)) %>%
mutate(`f.26413.0.0` = if_else(is.na(`f.26413.0.0`),`f.26420.0.0`,`f.26413.0.0`)) %>%
mutate(`f.26414.0.0` = if_else(is.na(`f.26414.0.0`),`f.26421.0.0`,`f.26414.0.0`)) %>%
mutate(`f.26414.0.0` = if_else(is.na(`f.26414.0.0`),`f.26431.0.0`,`f.26414.0.0`)) %>%
mutate(`f.26415.0.0` = if_else(is.na(`f.26415.0.0`),`f.26432.0.0`,`f.26415.0.0`)) %>%
mutate(`f.26415.0.0` = if_else(is.na(`f.26415.0.0`),`f.26423.0.0`,`f.26415.0.0`)) %>%
mutate(`f.26416.0.0` = if_else(is.na(`f.26416.0.0`),`f.26434.0.0`,`f.26416.0.0`))
to  <- list()
for(i in 1:4){
coh <- tibble(read_delim(paste0(dir_results,'Cohorts/imputedData_',ch[i],'.csv'))) %>%
select("eid" = "IID", 'Sex','Age') %>%
left_join(ukb %>%
select('eid',
'Body mass index' = 'f.21001.0.0',
'Index of multiple deprivation' = 'f.26410.0.0',
'Income score' = 'f.26411.0.0',
'Employment score' = 'f.26412.0.0',
'Health score' = 'f.26413.0.0',
'Education score' = 'f.26414.0.0',
'Housing score' = 'f.26415.0.0',
'Crime score' = 'f.26416.0.0',
'Living environment score' = 'f.26417.0.0'
),
by = "eid") %>%
mutate(Sex = if_else(Sex == 0,'Female','Male')) %>%
mutate('Sex' = as.factor(Sex))
to[[i]] <- CreateTableOne(data = coh,
vars = colnames(coh[2:length(colnames(coh))])) %>%
print(showAllLevels = TRUE)
}
tab <- tibble(data.frame(to[[1]])) %>%
rename("Immune response_One dose" = 'Overall') %>%
mutate(Variables = rownames(to[[1]])) %>%
relocate('Variables') %>%
left_join(
tibble(data.frame(to[[2]])) %>%
rename("Immune response_Two dose" = 'Overall') %>%
mutate(Variables = rownames(to[[2]])),
by = c('Variables','level'))%>%
left_join(
tibble(data.frame(to[[3]])) %>%
rename("Breakthrough_Susceptibility" = 'Overall') %>%
mutate(Variables = rownames(to[[3]])),
by = c('Variables','level')) %>%
left_join(
tibble(data.frame(to[[4]])) %>%
rename("Breakthrough_Severity" = 'Overall') %>%
mutate(Variables = rownames(to[[4]])),
by = c('Variables','level')) %>%
rename(' ' = 'level') %>%
flextable() %>%
span_header(sep = "_") %>%
align(j = c(3:5), align = 'center', part = 'all')
save_as_docx(values = tab, path = paste0(dir_results,'Tables/T1.docx'))
save_as_docx(tab, path = paste0(dir_results,'Tables/T1.docx'))
