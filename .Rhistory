flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ `Validation_P Value` < 0.7, j = 'a', color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(a = c(1,0.5,1,1,1,1,1,1,1,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ `Validation_P Value` < 0.05, j = 'a', color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID')
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i])
t %>% mutate(`Validation_P Value` = is.numeric(`Validation_P Value`))
t %>% mutate(`Validation_P Value` = as.numeric(`Validation_P Value`))
t
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`), format = "e"))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`), format = "e", digits = 1))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`), format = "exp", digits = 1))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`), format = "e", digits = 1))
t %>% mutate(`Validation_P Value` = format(`Validation_P Value`, format = "e", digits = 1))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`),`Validation_P Value`, format = "e", digits = 1))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`),`Validation_P Value`, format = "e", digits = 1))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`), scientific = TRUE))
t %>% mutate(`Validation_P Value` = format(as.numeric(`Validation_P Value`))
)
t %>% mutate(`Validation_P Value` = as.numeric(`Validation_P Value`))
t %>% mutate(`Validation_P Value` = as.numeric(`Validation_P Value`)) %>% mutate(`Validation_P Value` = format(`Validation_P Value`, scientific = TRUE))
# Table 2 - Validation
nam <- c('Immune response - one dose',
'Immune response - two dose',
'Breakthrough susceptibility',
'Breakthrough severity')
ch  <- c('oneDose',
'twoDose',
'breakthroughSusceptibility',
'breakthroughSeverity')
tableListValidation <- list()
tableListValidation
# Table 2 - Validation
nam <- c('Immune response - one dose',
'Immune response - two dose',
'Breakthrough susceptibility',
'Breakthrough severity')
ch  <- c('oneDose',
'twoDose',
'breakthroughSusceptibility',
'breakthroughSeverity')
tableListValidation <- list()
for(i in 1:4){
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
order <- getOrder(genomicRL)
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i]) %>%
left_join(
read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'.txt')) %>%
mutate('Main analysis_N' = N) %>%
mutate('Main analysis_OR' = round(exp(BETA), digits = 2)) %>%
mutate('Main analysis_P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1)) %>%
mutate('Main analysis_Lower' = exp(BETA-1.96*SE)) %>%
mutate('Main analysis_Upper' = exp(BETA+1.96*SE)) %>%
select(ID, 'Main analysis_N', 'Main analysis_OR', 'Main analysis_P Value',
'Main analysis_Lower', 'Main analysis_Upper'),
by = 'ID'
)
tableListValidation[[i]] <- t
}
gwas <- tableListValidation[[1]] %>%
add_row(tableListValidation[[2]]) %>%
add_row(tableListValidation[[3]]) %>%
add_row(tableListValidation[[4]])
write.table(gwas,paste0(dir_results,'/Validation/Validation.txt'))
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ `p` < 0.05, j = 'all', color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ `p` < 0.05, j = c('ID'), color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID'), color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID'), color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p))
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID',`Main analysis_N`,`Main analysis_OR`,`Main analysis_P Value`,
`Validation_N`,`Validation_OR`,`Validation_P Value`), color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable()
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red' )
gwas_validation
for(i in 1:4){
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
order <- getOrder(genomicRL)
gwas_validation <- read_delim(paste0(dir_results,'Validation/imputedData_',ch[i],'_Validation.txt'))
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i]) %>%
left_join(
read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'.txt')) %>%
mutate('Main analysis_N' = N) %>%
mutate('Main analysis_OR' = round(exp(BETA), digits = 2)) %>%
mutate('Main analysis_P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1)) %>%
mutate('Main analysis_Lower' = exp(BETA-1.96*SE)) %>%
mutate('Main analysis_Upper' = exp(BETA+1.96*SE)) %>%
select(ID, 'Main analysis_N', 'Main analysis_OR', 'Main analysis_P Value',
'Main analysis_Lower', 'Main analysis_Upper'),
by = 'ID'
)
tableListValidation[[i]] <- t
}
for(i in 1:4){
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
order <- getOrder(genomicRL)
gwas_validation <- read_delim(paste0(dir_data,'Validation/imputedData_',ch[i],'_Validation.txt'))
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i]) %>%
left_join(
read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'.txt')) %>%
mutate('Main analysis_N' = N) %>%
mutate('Main analysis_OR' = round(exp(BETA), digits = 2)) %>%
mutate('Main analysis_P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1)) %>%
mutate('Main analysis_Lower' = exp(BETA-1.96*SE)) %>%
mutate('Main analysis_Upper' = exp(BETA+1.96*SE)) %>%
select(ID, 'Main analysis_N', 'Main analysis_OR', 'Main analysis_P Value',
'Main analysis_Lower', 'Main analysis_Upper'),
by = 'ID'
)
tableListValidation[[i]] <- t
}
for(i in 1:4){
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
order <- getOrder(genomicRL)
gwas_validation <- read_delim(paste0(dir_data,'GWAS/imputedData_',ch[i],'_Validation.txt'))
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i]) %>%
left_join(
read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'.txt')) %>%
mutate('Main analysis_N' = N) %>%
mutate('Main analysis_OR' = round(exp(BETA), digits = 2)) %>%
mutate('Main analysis_P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1)) %>%
mutate('Main analysis_Lower' = exp(BETA-1.96*SE)) %>%
mutate('Main analysis_Upper' = exp(BETA+1.96*SE)) %>%
select(ID, 'Main analysis_N', 'Main analysis_OR', 'Main analysis_P Value',
'Main analysis_Lower', 'Main analysis_Upper'),
by = 'ID'
)
tableListValidation[[i]] <- t
}
paste0(dir_data,'GWAS/imputedData_',ch[i],'_Validation.txt')
gwas_validation <- read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'_Validation.txt'))
gwas_validation
# Table 2 - Validation
nam <- c('Immune response - one dose',
'Immune response - two dose',
'Breakthrough susceptibility',
'Breakthrough severity')
ch  <- c('oneDose',
'twoDose',
'breakthroughSusceptibility',
'breakthroughSeverity')
tableListValidation <- list()
for(i in 1:4){
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
order <- getOrder(genomicRL)
gwas_validation <- read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'_Validation.txt'))
t <- order %>% rename('ID' = 'SNP') %>%
left_join(gwas_validation,
by = 'ID') %>%
mutate(OR = round(exp(BETA), digits = 2)) %>%
mutate('P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1),
'Lower'   = exp(BETA-1.96*SE),
'Upper'   = exp(BETA+1.96*SE)) %>%
select(CHROM, ID, 'Validation_N' = 'N', 'Validation_OR' = 'OR', 'Validation_P Value' = 'P Value',
'Validation_Lower' = 'Lower', 'Validation_Upper' = 'Upper') %>%
mutate(Phenotype = nam[i]) %>%
left_join(
read_delim(paste0(dir_results,'GWAS/imputedData_',ch[i],'.txt')) %>%
mutate('Main analysis_N' = N) %>%
mutate('Main analysis_OR' = round(exp(BETA), digits = 2)) %>%
mutate('Main analysis_P Value' = formatC(10^{-LOG10P}, format = "e", digit = 1)) %>%
mutate('Main analysis_Lower' = exp(BETA-1.96*SE)) %>%
mutate('Main analysis_Upper' = exp(BETA+1.96*SE)) %>%
select(ID, 'Main analysis_N', 'Main analysis_OR', 'Main analysis_P Value',
'Main analysis_Lower', 'Main analysis_Upper'),
by = 'ID'
)
tableListValidation[[i]] <- t
}
gwas <- tableListValidation[[1]] %>%
add_row(tableListValidation[[2]]) %>%
add_row(tableListValidation[[3]]) %>%
add_row(tableListValidation[[4]])
write.table(gwas,paste0(dir_results,'/Validation/Validation.txt'))
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red' )
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red') %>%
select(-p)
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red') %>%
delete_part(p)
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ p < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red') %>%
select(-p)
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ as_numeric(`Validation_P Value`) < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red')
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
mutate(p = as.numeric(`Validation_P Value`)) %>%
mutate(p = if_else(is.na(p),1,p)) %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ as.numeric(`Validation_P Value`) < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red')
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ as.numeric(`Validation_P Value`) < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red')
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ as.numeric(`Validation_P Value`) < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red') %>%
hline(i=c(14))
gwas %>%
select(-CHROM,-`Main analysis_Lower`,-`Main analysis_Upper`,-`Validation_Upper`,-`Validation_Lower`) %>%
relocate('Main analysis_N', .after = 'ID') %>%
relocate('Main analysis_OR', .after = 'Main analysis_N') %>%
relocate('Main analysis_P Value', .after = 'Main analysis_OR') %>%
relocate('Phenotype', .before = 'ID') %>%
flextable() %>%
span_header(sep = "_") %>%
align(align = 'center', part = 'all') %>%
bg(j = c('Main analysis_N',
'Main analysis_P Value',
'Validation_OR'), bg = "#EFEFEF", part = "all")  %>%
color(i = ~ as.numeric(`Validation_P Value`) < 0.05, j = c('ID','Main analysis_N','Main analysis_OR','Main analysis_P Value',
'Validation_N','Validation_OR','Validation_P Value'), color = 'red') %>%
hline(i=c(14,16,25))
genomicRL
order <- genomicRL %>%
select(rsID,LeadSNPs,pval) %>%
mutate(num = str_count(LeadSNPs,";")) %>%
separate_rows(LeadSNPs, sep = ";") %>%
mutate(rsID = if_else(num > 0 & rsID == LeadSNPs, 'NA',rsID)) %>%
filter(rsID != 'NA') %>%
group_by(rsID) %>%
mutate(LeadSNPs = paste0(LeadSNPs, collapse = ";")) %>%
distinct() %>%
mutate(a = 1) %>%
group_by(a) %>%
summarise(SNP = paste0(rsID, ";", LeadSNPs, collapse = ";")) %>%
select(-a) %>%
separate_rows(SNP, sep = ";") %>%
distinct()
genomicRL %>%
select(rsID,LeadSNPs,p)
genomicRL %>%
select(rsID,LeadSNPs,p) %>%
mutate(num = str_count(LeadSNPs,";"))
genomicRL
i <- 1
genomicRL   <- read_delim(paste0(dir_results,'FUMA/',ch[i],'/GenomicRiskLoci.txt'))
genomicRL
genomicRL %>%
select(rsID,LeadSNPs,p) %>%
mutate(num = str_count(LeadSNPs,";"))
genomicRL %>%
select(rsID,LeadSNPs,p) %>%
mutate(num = str_count(LeadSNPs,";")) %>%
arrange(p)
