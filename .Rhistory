inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:9), part = "header") %>%
vline(i = 2, j = seq(6,12,1), part = "header") %>%
vline(i = 3, j = seq(6,15,3), part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:9), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:10), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(10,12,14,16), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(12,13,14), bg = "#EFEFEF", part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(10,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(12,14,15), bg = "#EFEFEF", part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(10,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(11,14,15), bg = "#EFEFEF", part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(10,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(13,14,15), bg = "#EFEFEF", part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(10,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(11), bg = "#EFEFEF", part = "header")
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(11,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(13), bg = "#EFEFEF", part = "header")
gwas
gwas <- gwas_onedose %>%
inner_join(gwas_twodose) %>% inner_join(gwas_suscep) %>% inner_join(gwas_sever) %>%
left_join(mapping %>% rename(SNP = rsID)) %>%
mutate('Immune response_One dose_Beta' = exp(`Immune response_One dose_Beta`),
'Immune response_Two dose_Beta' = exp(`Immune response_Two dose_Beta`),
'Breakthrough_Susceptibility_Beta' = exp(`Breakthrough_Susceptibility_Beta`),
'Breakthrough_Severity_Beta' = exp(`Breakthrough_Severity_Beta`)) %>%
arrange(CHR) %>%
mutate(`Immune response_One dose_EAF` = round(`Immune response_One dose_EAF`, digits = 2),
`Immune response_One dose_Beta` = round(`Immune response_One dose_Beta`, digits = 2),
`Immune response_One dose_P Value` = formatC(`Immune response_One dose_P Value`, format = "e", digits = 1),
`Immune response_Two dose_EAF` = round(`Immune response_Two dose_EAF`, digits = 2),
`Immune response_Two dose_Beta` = round(`Immune response_Two dose_Beta`, digits = 2),
`Immune response_Two dose_P Value` = formatC(`Immune response_Two dose_P Value`, format = "e", digits = 1),
`Breakthrough_Susceptibility_EAF` = round(`Breakthrough_Susceptibility_EAF`, digits = 2),
`Breakthrough_Susceptibility_Beta` = round(`Breakthrough_Susceptibility_Beta`, digits = 2),
`Breakthrough_Susceptibility_P Value` = formatC(`Breakthrough_Susceptibility_P Value`, format = "e", digits = 1),
`Breakthrough_Severity_EAF` = round(`Breakthrough_Severity_EAF`, digits = 2),
`Breakthrough_Severity_Beta` = round(`Breakthrough_Severity_Beta`, digits = 2),
`Breakthrough_Severity_P Value` = formatC(`Breakthrough_Severity_P Value`, format = "e", digits = 1)) %>%
rename("EA" = ALLELE1, 'Nearest gene' = nearestGene, 'Function' = func) %>%
mutate("SNP" = if_else(SNP == "6:32419074_CT_C","rs2150392827",SNP)) %>%
relocate(CHR) %>%
relocate('Nearest gene', .after = SNP) %>%
relocate('Function', .before = 'Nearest gene') %>%
relocate('BP', .after = 'CHR') %>%
flextable() %>%
span_header(sep = "_",) %>%
align(i = 1, align = 'center', part = "header") %>%
align(i = 2, align = 'center', part = "header") %>%
align(i = 3, align = 'center', part = "header") %>%
align(align = "center",part = "all") %>%
vline(i = 1, j = c(6:18), part = "header") %>%
vline(i = 2, j = seq(6,18,1), part = "header") %>%
vline(i = 3, j = seq(6,18,3), part = "header") %>%
vline(j = seq(6,18,3), part = "body") %>%
bg(j = "Immune response_One dose_EAF", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_One dose_P Value", bg = "#EFEFEF", part = "all") %>%
bg(j = "Immune response_Two dose_Beta", bg = "#EFEFEF", part = "body") %>%
bg(i = 3, j = c(11,13,15,17), bg = "#EFEFEF", part = "header") %>%
bg(i = 2, j = c(13), bg = "#EFEFEF", part = "header")%>%
bg(j = "Breakthrough_Susceptibility_EAF", bg = "#EFEFEF", part = "body") %>%
bg(j = "Breakthrough_Susceptibility_P Value",bg = "#EFEFEF", part = "body") %>%
bg(j = "Breakthrough_Severity_Beta",bg = "#EFEFEF", part = "body") %>%
width(j = 1, width = 1, unit = "in") %>%
bold(bold = TRUE, part="header") %>%
width(j = "Immune response_One dose_EAF", width = 1.2, unit = 'cm') %>%
width(j = "Immune response_Two dose_EAF", width = 1.2, unit = 'cm') %>%
width(j = "Breakthrough_Susceptibility_EAF", width = 1.2, unit = 'cm') %>%
width(j = "Breakthrough_Severity_EAF", width = 1.2, unit = 'cm') %>%
width(j = "Immune response_One dose_Beta", width = 1.2, unit = 'cm') %>%
width(j = "Immune response_Two dose_Beta", width = 1.2, unit = 'cm') %>%
width(j = "Breakthrough_Susceptibility_Beta", width = 1.2, unit = 'cm') %>%
width(j = "Breakthrough_Severity_Beta", width = 1.2, unit = 'cm') %>%
width(j = "Immune response_One dose_P Value", width = 1.6, unit = 'cm') %>%
width(j = "Immune response_Two dose_P Value", width = 1.6, unit = 'cm') %>%
width(j = "Breakthrough_Susceptibility_P Value", width = 1.6, unit = 'cm') %>%
width(j = "Breakthrough_Severity_P Value", width = 1.6, unit = 'cm') %>%
width(j = "SNP", width = 2.7, unit = 'cm') %>%
width(j = "CHR", width = 2.65, unit = 'cm') %>%
width(j = "Nearest gene", width = 2.3, unit = 'cm') %>%
width(j = "EA", width = 1.1, unit = 'cm') %>%
fontsize(size = 11, part = "all") %>%
font(fontname='Calibri',part = "all")
gwas
save_as_docx(gwas, path=paste0(dir_results,'Tables/Table.docx'), align = "center")
mapping
a1
a1 %>% filter(rsID == 'rs7132420')
a1 <-read_table(paste0(dir_results,'Mapping/snps_2.txt'))
a1 %>% filter(rsID == 'rs7132420')
a1 <-read_table(paste0(dir_results,'Mapping/snps_3.txt'))
a1 %>% filter(rsID == 'rs7132420')
a1 <-read_table(paste0(dir_results,'Mapping/snps_1.txt'))
a1 %>% filter(rsID == 'rs71322420')
read_table(paste0(dir_results,'Mapping/snps_1.txt'))
a1
a1$pos
a1 <-read_table(paste0(dir_results,'Mapping/snps_2.txt'))
a1$pos
a1 %>% filter(rsID == 'rs71322420')
