#                               IMMUNE RESPONSE                                #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
# Cohort -----------------------------------------------------------------------
print("load databases")
ukb_covid <- as_tibble(read.delim(paste0(dir_data,"immune_response.tab"))) %>%
select("eid" = "f.eid",
"Antibody_test_result" = "f.27981.0.0",
"Date_antibody_test_performed" = "f.27982.0.0",
"Received_first_COVID19_vaccination" = "f.27983.0.0",
"Date_first_COVID19_vaccination" = "f.27984.0.0",
"Received_second_COVID19_vaccination" = "f.27985.0.0",
"Date_second_COVID19_vaccination" = "f.27986.0.0",
"Covid_antibody_test_results" = "f.27990.0.0") %>%
mutate(Antibody_test_result = if_else(Antibody_test_result == 2,1,Antibody_test_result)) %>%
mutate(Date_first_COVID19_vaccination  = as.Date(Date_first_COVID19_vaccination,"%Y-%m-%d"),
Year_first_COVID19_vaccination  = year(Date_first_COVID19_vaccination),
Date_second_COVID19_vaccination = as.Date(Date_second_COVID19_vaccination,"%Y-%m-%d"),
Year_second_COVID19_vaccination = year(Date_second_COVID19_vaccination),
Date_antibody_test_performed    = as.Date(Date_antibody_test_performed,"%Y-%m-%d"),
Year_antibody_test_performed    = year(Date_antibody_test_performed))
ukb_covar <- as_tibble(read_delim(paste0(dir_data,'ukb65397_covariates.csv')))
# Attrition --------------------------------------------------------------------
print("load attrition")
attr(ukb_covid, "cohort_attrition") <- tibble("N" = ukb_covid |> nrow(),
"Reason"   = "UK Biobank participants",
"Excluded" = 0)
# Main analysis ----------------------------------------------------------------
print("load main analysis")
ukb_covar
# Main analysis ----------------------------------------------------------------
print("load main analysis")
vaccine_cohort <- ukb_covid |>
filter(!is.na(Antibody_test_result)) |>
recordAttrition(reason = "participants in the SARS-CoV-2 coronavirus antibody seroprevalence study") |>
left_join(ukb_covar, by = "eid") |>
filter(Caucasian == 1) |>
recordAttrition(reason = "participants with European ancestry") |>
filter(Sex == genetic_sex) |>
recordAttrition(reason = "participants with the same sex and genetic sex registered") |>
filter(is.na(sex_chromosome_aneuploidy)) %>%
recordAttrition(reason = "participants with no sex chromosome aneuploidy") |>
filter(kinship_to_other_participants == 0) |>
recordAttrition(reason = "no kinship to other participants") |>
filter(Received_first_COVID19_vaccination == 1) %>%
recordAttrition(reason = "participants that have received at least one dose of a COVID-19 vaccine") |>
filter(Year_first_COVID19_vaccination >= 2021) |>
recordAttrition(reason = "participants were vaccinated after 2021") |>
filter(Covid_antibody_test_results == 0 | is.na(Covid_antibody_test_results)) |>
recordAttrition(reason = "participants tested negative or did not test for COVID-19 infection") |>
filter(Year_antibody_test_performed >= 2021) |>
recordAttrition(reason = "participants COVID-19 test date is valid")
12*8
7*8
7*12
one_vaccine_cohort <- vaccine_cohort |>
filter(Received_second_COVID19_vaccination == 0) |>
recordAttrition(reason = "participants have not received a second covid-19 vaccine dose") |>
mutate(Days_since_vaccine = as.numeric(difftime(Date_antibody_test_performed,Date_first_COVID19_vaccination, units = "days"))) %>%
# filter(Days_since_vaccine >= 8,
#        Days_since_vaccine <= 56) |>
filter(Days_since_vaccine > 0, Days_since_vaccine <= 84) |>
recordAttrition(reason = "participants have received the first COVID-19 vaccine between 7 and 56 days before the antibody test") |>
mutate(Age_antibody_test_performed = Year_antibody_test_performed - Year_of_birth) |>
mutate('FID' = eid, 'IID' = eid) |>
relocate('FID', 'IID') |>
select(FID, IID,
immuneResponse = Antibody_test_result,
Sex,
Age = Age_antibody_test_performed,
Genetic_batch,
PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10)
one_vaccine_cohor
one_vaccine_cohort
attr(one_vaccine_cohort,"cohort_attrition") <- attr(one_vaccine_cohort,"cohort_attrition") |>
union_all(tibble("N" = c(one_vaccine_cohort |> filter(immuneResponse == 1) |> tally() |> pull(),
one_vaccine_cohort |> filter(immuneResponse == 0) |> tally() |> pull()),
"Reason" = c("cases","controls"),
"Excluded" = 0))
attr(one_vaccine_cohort,"cohort_attrition")
write.table(one_vaccine_cohort, paste0(dir_results,'Cohorts/one_dose_original.txt'), row.names = FALSE)
write.table(attr(one_vaccine_cohort,"cohort_attrition"), paste0(dir_results,'Cohorts/one_dose_attrition_original.txt'), row.names = FALSE)
one_dose_cohort <- as.phe(one_vaccine_cohort, "FID", "IID")
write.phe(paste0(dir_results,'/Cohorts/one_dose_original.phe'), one_dose_cohort)
# ============================================================================ #
#                                 CODE TO RUN                                  #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
rm(list = ls())
rm(list = ls())
library("dplyr")
library("readr")
library("here")
library("lubridate")
library("pbatR")
library("tableone")
library("ggplot2")
library("stringr")
library("tidyverse")
library("flextable")
library("ftExtra")
library(coloc)
source(here("R_Scripts/Functions.R"))
# Directory where the data is
dir_data    <- 'D:/Projects/VaccineResponse_GWAS/'
dir_ukb     <- 'D:/Projects/UKBiobank_65397/'
dir_results <- 'D:/Projects/VaccineResponse_GWAS/Results/'
t <- read.table("C:/Users/martaa/OneDrive - Nexus365/Marta/Projects/Breakthough_infection_GWAS/manuscript_versions/1-first_revision/Results/GWAS/oneDose_assoc.regenie.merged_new.txt", header = TRUE)
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_breakthroughSeverity.phe")
cohort_old
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_breakthroughSeverity.phe", sep = "\tab")
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_breakthroughSeverity.phe", sep = " ")
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_breakthroughSeverity.phe", sep = " ", header = TRUE)
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_imputedData_oneDose.phe", sep = " ", header = TRUE)
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.phe", sep = " ", header = TRUE)
cohort_old
cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.phe", sep = " ", header = TRUE) |> as_tibble()
cohort_old
cohort_new <- read.table("D:/Projects/VaccineResponse_GWAS/Results/Cohorts/imputedData_oneDose.phe", sep = " ", header = TRUE) |> as_tibble()
cohort_new <- read.table("D:/Projects/VaccineResponse_GWAS/Results/Cohorts/oneDose.phe", sep = " ", header = TRUE) |> as_tibble()
cohort_new <- read.table("D:/Projects/VaccineResponse_GWAS/Results/Cohorts/one_dose.phe", sep = " ", header = TRUE) |> as_tibble()
cohort_new
cohort_new <- read.table("D:/Projects/VaccineResponse_GWAS/Results/Cohorts/one_dose_original.phe", sep = " ", header = TRUE) |> as_tibble()
cohort_new
cohort_old |> select(FID, immuneResponse) |>
inner_join(
cohort_new |> select(FID, immuneResponse1 = immuneResponse)
)
cohort_old |> select(FID, immuneResponse) |>
inner_join(
cohort_new |> select(FID, immuneResponse1 = immuneResponse)
) |> filter(immuneResponse != immuneResponse1)
cohort_old |> select(FID, Sex) |>
inner_join(
cohort_new |> select(FID, Sex1 = Sex)
) |> filter(Sex != Sex1)
cohort_old |> select(FID, Age) |>
inner_join(
cohort_new |> select(FID, Age1 = Age)
) |> filter(Age != Age1)
cohort_old |> select(FID, Genetic_batch) |>
inner_join(
cohort_new |> select(FID, Genetic_batch1 = Genetic_batch)
) |> filter(Genetic_batch != Genetic_batch1)
cohort_old |> select(FID, PC1) |>
inner_join(
cohort_new |> select(FID, PC11 = PC1)
) |> filter(PC1 != PC11)
cohort_old |> select(FID, PC2) |>
inner_join(
cohort_new |> select(FID, PC22 = PC2)
) |> filter(PC2 != PC22)
cohort_old |> select(FID, PC3) |>
inner_join(
cohort_new |> select(FID, PC33 = PC3)
) |> filter(PC3 != PC33)
cohort_old |> select(FID, PC4) |>
inner_join(
cohort_new |> select(FID, PC44 = PC4)
) |> filter(PC4 != PC44)
cohort_old |> select(FID, PC5) |>
inner_join(
cohort_new |> select(FID, PC55 = PC5)
) |> filter(PC5 != PC55)
cohort_old |> select(FID, PC6) |>
inner_join(
cohort_new |> select(FID, PC65 = PC6)
) |> filter(PC6 != PC65)
cohort_old |> select(FID, PC7) |>
inner_join(
cohort_new |> select(FID, PC75 = PC7)
) |> filter(PC7 != PC75)
cohort_old |> select(FID, PC8) |>
inner_join(
cohort_new |> select(FID, PC85 = PC8)
) |> filter(PC8 != PC85)
cohort_old |> select(FID, PC9) |>
inner_join(
cohort_new |> select(FID, PC95 = PC9)
) |> filter(PC9 != PC95)
cohort_old |> select(FID, PC10) |>
inner_join(
cohort_new |> select(FID, PC105 = PC10)
) |> filter(PC10 != PC105)
t <- read.table("C:/Users/martaa/OneDrive - Nexus365/Marta/Projects/Breakthough_infection_GWAS/manuscript_versions/1-first_revision/Results/GWAS/oneDose_assoc.regenie.merged_new.txt", header = TRUE)
t
t1 <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/GWAS/imputedData_oneDose.txt", header = TRUE)
t <- t |> as_tibble()
t1 <- t1 |> as_tibble()
rm(list = ls())
library("dplyr")
library("readr")
library("here")
library("lubridate")
library("pbatR")
library("tableone")
library("ggplot2")
library("stringr")
library("tidyverse")
library("flextable")
library("ftExtra")
library(coloc)
source(here("R_Scripts/Functions.R"))
# Directory where the data is
dir_data    <- 'D:/Projects/VaccineResponse_GWAS/'
dir_ukb     <- 'D:/Projects/UKBiobank_65397/'
dir_results <- 'D:/Projects/VaccineResponse_GWAS/Results/'
# ============================================================================ #
#                               IMMUNE RESPONSE                                #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
# Cohort -----------------------------------------------------------------------
print("load databases")
ukb_covid <- as_tibble(read.delim(paste0(dir_data,"immune_response.tab"))) %>%
select("eid" = "f.eid",
"Antibody_test_result"         = "f.27981.0.0",
"Date_antibody_test_performed" = "f.27982.0.0",
"Received_first_COVID19_vaccination"  = "f.27983.0.0",
"Date_first_COVID19_vaccination"      = "f.27984.0.0",
"Received_second_COVID19_vaccination" = "f.27985.0.0",
"Date_second_COVID19_vaccination" = "f.27986.0.0",
"Covid_antibody_test_results"     = "f.27990.0.0") %>%
mutate(Antibody_test_result = if_else(Antibody_test_result == 2,1,Antibody_test_result)) %>%
mutate(Date_first_COVID19_vaccination  = as.Date(Date_first_COVID19_vaccination,"%Y-%m-%d"),
Year_first_COVID19_vaccination  = year(Date_first_COVID19_vaccination),
Date_second_COVID19_vaccination = as.Date(Date_second_COVID19_vaccination,"%Y-%m-%d"),
Year_second_COVID19_vaccination = year(Date_second_COVID19_vaccination),
Date_antibody_test_performed    = as.Date(Date_antibody_test_performed,"%Y-%m-%d"),
Year_antibody_test_performed    = year(Date_antibody_test_performed))
ukb_covar <- as_tibble(read_delim(paste0(dir_data,'ukb65397_covariates.csv')))
ukb_covar
ukb_covar <- as_tibble(read.delim(paste0(dir_data,'ukb65397_covariates.csv')))
ukb_covar
ukb_covar <- as_tibble(read.delim(paste0(dir_data,'ukb65397_covariates.csv'), delim = ","))
ukb_covar <- as_tibble(read.delim(paste0(dir_data,'ukb65397_covariates.csv'), sep = ","))
ukb_covar
ukb_covar <- as_tibble(read.delim(paste0(dir_data,'ukb65397_covariates.csv'), sep = ",")) |>
select(-"x")
# Attrition --------------------------------------------------------------------
print("load attrition")
attr(ukb_covid, "cohort_attrition") <- tibble("N" = ukb_covid |> nrow(),
"Reason"   = "UK Biobank participants",
"Excluded" = 0)
# Main analysis ----------------------------------------------------------------
print("load main analysis")
vaccine_cohort <- ukb_covid |>
filter(!is.na(Antibody_test_result)) |>
recordAttrition(reason = "participants in the SARS-CoV-2 coronavirus antibody seroprevalence study") |>
left_join(ukb_covar, by = "eid") |>
filter(Caucasian == 1) |>
recordAttrition(reason = "participants with European ancestry") |>
filter(Sex == genetic_sex) |>
recordAttrition(reason = "participants with the same sex and genetic sex registered") |>
filter(is.na(sex_chromosome_aneuploidy)) %>%
recordAttrition(reason = "participants with no sex chromosome aneuploidy") |>
filter(kinship_to_other_participants == 0) |>
recordAttrition(reason = "no kinship to other participants") |>
filter(Received_first_COVID19_vaccination == 1) %>%
recordAttrition(reason = "participants that have received at least one dose of a COVID-19 vaccine") |>
filter(Year_first_COVID19_vaccination >= 2021) |>
recordAttrition(reason = "participants were vaccinated after 2021") |>
filter(Covid_antibody_test_results == 0 | is.na(Covid_antibody_test_results)) |>
recordAttrition(reason = "participants tested negative or did not test for COVID-19 infection") |>
filter(Year_antibody_test_performed >= 2021) |>
recordAttrition(reason = "participants COVID-19 test date is valid")
# One dose vaccine cohort ------------------------------------------------------
print("load one dose cohort")
one_vaccine_cohort <- vaccine_cohort |>
filter(Received_second_COVID19_vaccination == 0) |>
recordAttrition(reason = "participants have not received a second covid-19 vaccine dose") |>
mutate(Days_since_vaccine = as.numeric(difftime(Date_antibody_test_performed,Date_first_COVID19_vaccination, units = "days"))) %>%
# filter(Days_since_vaccine >= 8,
#        Days_since_vaccine <= 56) |>
filter(Days_since_vaccine > 0, Days_since_vaccine <= 84) |>
recordAttrition(reason = "participants have received the first COVID-19 vaccine between 7 and 56 days before the antibody test") |>
mutate(Age_antibody_test_performed = Year_antibody_test_performed - Year_of_birth) |>
mutate('FID' = eid, 'IID' = eid) |>
relocate('FID', 'IID') |>
select(FID, IID,
immuneResponse = Antibody_test_result,
Sex,
Age = Age_antibody_test_performed,
Genetic_batch,
PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10)
one_vaccine_cohort <- vaccine_cohort |>
filter(Received_second_COVID19_vaccination == 0) |>
recordAttrition(reason = "participants have not received a second covid-19 vaccine dose") |>
mutate(Days_since_vaccine = as.numeric(difftime(Date_antibody_test_performed,Date_first_COVID19_vaccination, units = "days"))) %>%
# filter(Days_since_vaccine >= 8,
#        Days_since_vaccine <= 56) |>
filter(Days_since_vaccine > 0, Days_since_vaccine <= 84) |>
recordAttrition(reason = "participants have received the first COVID-19 vaccine between 7 and 56 days before the antibody test") |>
mutate(Age_antibody_test_performed = Year_antibody_test_performed - Year_of_birth) |>
mutate('FID' = eid, 'IID' = eid) |>
relocate('FID', 'IID') |>
select(FID, IID,
immuneResponse = Antibody_test_result,
Sex,
Age = Age_antibody_test_performed,
Genetic_batch,
starts_with("PC"))
one_vaccine_cohort
one_vaccine_cohort |> group_by(Sex) |> tally()
one_vaccine_cohort
one_vaccine_cohort |> summarise(mean(Age))
one_vaccine_cohort_old <- read.table("D:\Projects\VaccineResponse_GWAS\Results_old\Cohorts\imputedData_oneDose.phe")
one_vaccine_cohort_old <- read.phe("D:\Projects\VaccineResponse_GWAS\Results_old\Cohorts\imputedData_oneDose.phe")
one_vaccine_cohort_old <- read.table("D:\Projects\VaccineResponse_GWAS\Results_old\Cohorts\imputedData_oneDose.csv")
one_vaccine_cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.csv")
one_vaccine_cohort_old
one_vaccine_cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.csv", sep = ",")
one_vaccine_cohort_old
one_vaccine_cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.csv", sep = ",") |> as_tibble()
one_vaccine_cohort_old
one_vaccine_cohort_old <- read.table("D:/Projects/VaccineResponse_GWAS/Results_old/Cohorts/imputedData_oneDose.csv", sep = ",", header = TRUE) |> as_tibble()
one_vaccine_cohort_old
one_vaccine_cohort_old |> filter(FID == 1000047)
one_vaccine_cohort |> filter(FID == 1000047)
one_vaccine_cohort_old |> filter(FID == 2000047)
median(one_vaccine_cohort_old)
median(one_vaccine_cohort_old$eid)
median(one_vaccine_cohort_old$FID)
one_vaccine_cohort_old |> filter(FID == 3506011)
one_vaccine_cohort_old$eid[50000]
one_vaccine_cohort_old$FID[50000]
one_vaccine_cohort_old |> filter(FID ==  4916219)
one_vaccine_cohort
one_vaccine_cohort_old |> filter(FID ==  4916219)
one_vaccine_cohort |> filter(FID ==  4916219)
library(DBI)
library(CDMConnector)
library(log4r)
library(here)
library(readr)
library(zip)
library(RPostgres)
# Connect to database ----------------------------------------------------------
# please see examples how to connect to the database here:
# https://darwin-eu.github.io/CDMConnector/articles/a04_DBI_connection_examples.html
server_dbi <- Sys.getenv("server_dbi")
user       <- Sys.getenv("user")
port       <- Sys.getenv("port")
host       <- Sys.getenv("host")
#Connect to the database
db <- dbConnect(RPostgres::Postgres(),
dbname = server_dbi,
port = port,
host = host,
user = user,
password = Sys.getenv("password"))
usethis::edit_r_environ()
# Connect to database ----------------------------------------------------------
# please see examples how to connect to the database here:
# https://darwin-eu.github.io/CDMConnector/articles/a04_DBI_connection_examples.html
server_dbi <- Sys.getenv("server_dbi")
user       <- Sys.getenv("user")
port       <- Sys.getenv("port")
host       <- Sys.getenv("host")
#Connect to the database
db <- dbConnect(RPostgres::Postgres(),
dbname = server_dbi,
port = port,
host = host,
user = user,
password = Sys.getenv("password"))
library(DBI)
library(CDMConnector)
library(log4r)
library(here)
library(readr)
library(zip)
library(RPostgres)
# Connect to database ----------------------------------------------------------
# please see examples how to connect to the database here:
# https://darwin-eu.github.io/CDMConnector/articles/a04_DBI_connection_examples.html
server_dbi <- Sys.getenv("server_dbi")
user       <- Sys.getenv("user")
port       <- Sys.getenv("port")
host       <- Sys.getenv("host")
#Connect to the database
db <- dbConnect(RPostgres::Postgres(),
dbname = server_dbi,
port = port,
host = host,
user = user,
password = Sys.getenv("password"))
usethis::edit_r_environ()
library(DBI)
library(CDMConnector)
library(log4r)
library(here)
library(readr)
library(zip)
library(RPostgres)
# Connect to database ----------------------------------------------------------
# please see examples how to connect to the database here:
# https://darwin-eu.github.io/CDMConnector/articles/a04_DBI_connection_examples.html
server_dbi <- Sys.getenv("server_dbi")
user       <- Sys.getenv("user")
port       <- Sys.getenv("port")
host       <- Sys.getenv("host")
#Connect to the database
db <- dbConnect(RPostgres::Postgres(),
dbname = server_dbi,
port = port,
host = host,
user = user,
password = Sys.getenv("password"))
db
rm(list = ls())
library("dplyr")
library("readr")
library("here")
library("lubridate")
library("pbatR")
library("tableone")
library("ggplot2")
library("stringr")
library("tidyverse")
library("flextable")
library("ftExtra")
library("coloc")
source(here("R_Scripts/Functions.R"))
dir_data    <- 'D:/Projects/VaccineResponse_GWAS/'
dir_ukb     <- 'D:/Projects/UKBiobank_65397/'
dir_results <- 'D:/Projects/VaccineResponse_GWAS/Results/'
as_tibble(read.delim(paste0(dir_data,"immune_response.tab")))
readRDS(here(paste0(dir_data,'breakthrough.rds')))
# ============================================================================ #
#                           BREAKTHROUGH IMPUTED DATA                          #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
# Create cohort ----------------------------------------------------------------
ukb <- as_tibble(read.table("D:\\Projects\\UKBiobank_98358\\ukb673925.tab", header=TRUE, sep="\t"))
# ============================================================================ #
#                           BREAKTHROUGH IMPUTED DATA                          #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
# Create cohort ----------------------------------------------------------------
ukb <- as_tibble(read.table(paste0(dir_data,"UKBiobank_98358/ukb673925.tab"), header=TRUE, sep="\t"))
# ============================================================================ #
#                           BREAKTHROUGH IMPUTED DATA                          #
#                            Marta Alcalde Herraiz                             #
# ============================================================================ #
# Create cohort ----------------------------------------------------------------
ukb <- as_tibble(read.table(paste0(dir_data,"UKBiobank/ukb673925.tab"), header=TRUE, sep="\t"))
ukb
library("tidyverse")
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/ukb673925.tab", header = TRUE, sep = "\t"))
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/ukb673925.tab"), header = TRUE, sep = "\t")
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/ukb673925.tab"), header = TRUE, sep = "\t") |> as_tibble()
covid19_result_england
covid19_result_england
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/covid_19_result_england"), header = TRUE, sep = "\t") |>
as_tibble() |>
mutate( specdate = lubridate::dmy(specdate))
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/covid_19_result_england.txt"), header = TRUE, sep = "\t") |>
as_tibble() |>
mutate( specdate = lubridate::dmy(specdate))
covid19_result_england <- read.table(paste0(dir_data,"UKBiobank/covid19_result_england.txt"), header = TRUE, sep = "\t") |>
as_tibble() |>
mutate( specdate = lubridate::dmy(specdate))
covid19_result_england
ukb
bd <- read.table(paste0(dir_data,"UKBiobank/ukb678269.tab"), header=TRUE, sep="\t")
bd <- read.table(paste0(dir_data,"UKBiobank/vaccination_data.tab"), header=TRUE, sep="\t")
bd$f.32041.0.0 <- as.Date(bd$f.32041.0.0)
bd$f.32041.1.0 <- as.Date(bd$f.32041.1.0)
bd$f.32041.2.0 <- as.Date(bd$f.32041.2.0)
bd$f.32041.3.0 <- as.Date(bd$f.32041.3.0)
bd$f.32041.4.0 <- as.Date(bd$f.32041.4.0)
bd$f.32041.5.0 <- as.Date(bd$f.32041.5.0)
bd$f.32041.6.0 <- as.Date(bd$f.32041.6.0)
bd$f.32041.7.0 <- as.Date(bd$f.32041.7.0)
bd$f.32041.8.0 <- as.Date(bd$f.32041.8.0)
bd$f.32041.9.0 <- as.Date(bd$f.32041.9.0)
loadVaccinationData <- function(path){
bd <- read.table(paste0(dir_data,"UKBiobank/vaccination_data.tab"), header=TRUE, sep="\t")
bd$f.32041.0.0 <- as.Date(bd$f.32041.0.0)
bd$f.32041.1.0 <- as.Date(bd$f.32041.1.0)
bd$f.32041.2.0 <- as.Date(bd$f.32041.2.0)
bd$f.32041.3.0 <- as.Date(bd$f.32041.3.0)
bd$f.32041.4.0 <- as.Date(bd$f.32041.4.0)
bd$f.32041.5.0 <- as.Date(bd$f.32041.5.0)
bd$f.32041.6.0 <- as.Date(bd$f.32041.6.0)
bd$f.32041.7.0 <- as.Date(bd$f.32041.7.0)
bd$f.32041.8.0 <- as.Date(bd$f.32041.8.0)
bd$f.32041.9.0 <- as.Date(bd$f.32041.9.0)
return(bd)
}
vaccine_diagnosis_source <- loadVaccinationData(paste0(dir_data,"UKBiobank/vaccionation_data.tab"))
loadVaccinationData <- function(path){
bd <- read.table(paste0(dir_data,"UKBiobank/vaccination_data.tab"), header=TRUE, sep="\t")
bd$f.32041.0.0 <- as.Date(bd$f.32041.0.0)
bd$f.32041.1.0 <- as.Date(bd$f.32041.1.0)
bd$f.32041.2.0 <- as.Date(bd$f.32041.2.0)
bd$f.32041.3.0 <- as.Date(bd$f.32041.3.0)
bd$f.32041.4.0 <- as.Date(bd$f.32041.4.0)
bd$f.32041.5.0 <- as.Date(bd$f.32041.5.0)
bd$f.32041.6.0 <- as.Date(bd$f.32041.6.0)
bd$f.32041.7.0 <- as.Date(bd$f.32041.7.0)
bd$f.32041.8.0 <- as.Date(bd$f.32041.8.0)
bd$f.32041.9.0 <- as.Date(bd$f.32041.9.0)
return(bd)
}
vaccine_diagnosis_source <- loadVaccinationData()
vaccine_diagnosis_source
covid19_result_england
vaccine_diagnosis_source
read.table(paste0(dir_data,"UKBiobank/covid19_vaccionation.txt"), header = TRUE, sep = "\t")
read.table(paste0(dir_data,"UKBiobank/covid19_vaccination.txt"), header = TRUE, sep = "\t")
covid19_result_england
